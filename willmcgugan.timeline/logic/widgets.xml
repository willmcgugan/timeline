<?xml version="1.0" encoding="UTF-8"?>
<moya xmlns="http://moyaproject.com"
      xmlns:let="http://moyaproject.com/let">
    <!-- define your widgets here -->

    <widget name="stream" template="widgets/stream.html">
    	<signature>
    		<attribute name="id" type="expression" default="'stream-' + token:10"/>
    		<attribute name="events" type="expression"/>
    		<attribute name="source" type="text"/>
    		<attribute name="stream_id" type="expression" default="None"/>
    	</signature>
    	
    	<dict dst="config"
    		let:stream_id="stream_id"
    		let:source="source"
    		let:time="events.first.time.epoch"
    		let:watcherurl="slashjoin:[.app.settings.watcher_url, 'events', source]">
    		<get-url name="jsonrpc_private" dst="rpc_url"/>
    	</dict>
    	<js>
            $(function(){
                $('#${id}').inthingStream(${json:config});
            });
        </js>
    </widget>

</moya>
