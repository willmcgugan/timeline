<?xml version="1.0" encoding="UTF-8"?>
<moya xmlns="http://moyaproject.com"
      xmlns:let="http://moyaproject.com/let"
      xmlns:db="http://moyaproject.com/db"
      xmlns:forms="http://moyaproject.com/forms"
      xmlns:html="http://moyaproject.com/html"
      xmlns:w="http://moyaproject.com/widgets"
      xmlns:comments="http://moyaproject.com/comments">

    <!-- Content is a high level description of a page -->
    <content libname="content.base" template="base.html" final="yes">
        <!--
        <include-js path="js/jquery.js" from="moya.twitter.bootstrap"/>
        <include-js path="js/bootstrap.min.js" from="moya.twitter.bootstrap"/>
    -->
        <include-js path="js/jsonrpc.js" from="moya.jsonrpc"/>
        <include-js path="js/timeline.js"/>
        <include-js path="highlight/highlight.pack.js"/>


        <!--
        <include-css path="css/bootstrap.min.css" from="moya.twitter.bootstrap"/>
        <include-css path="css/timeline.css"/>
        <include-css path="highlight/styles/github.css"/>
    -->
    </content>

    <content libname="content.stream.new_event">
    	<section name="body">
    		<w:info>
    			<markdown>
This for can be used to create events.

It's designed to be used by automated systems. You should probably use the official API.
    			</markdown>
    		</w:info>
    		<render src="form"/>
    		<w:success if="event">
    			Added ${event}
    		</w:success>
    	</section>
    </content>

    <content libname="content.stream.base" extends="#content.base" template="stream_base.html">
    </content>

    <content libname="content.stream" extends="#content.stream.base">
        <section name="main">
            <node template="fragments/events.html" let:events="events"/>
        </section>
        <section name="side">
            <node template="stream_info.html" let:stream="stream"/>
        </section>
    </content>

    <content libname="content.timeline" extends="#content.stream.base">
        <section name="main">
            <node template="fragments/events.html" let:events="events"/>
        </section>
        <section name="side">

        </section>
    </content>

    <content libname="content.event" extends="#content.base" template="view_event.html">
        <section name="event">
            <node template="event.html" let:event="event"/>
        </section>
        <section name="comments">
            <comments:comments markup="markdown" namespace="app-${.app.name}" topic="event-${event.uuid}"
                url="${.urls.timeline.event(event_id=event.uuid)}"/>
        </section>
    </content>

</moya>
